<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>前端面试 Blog</title>
        <link>https://gvray.github.io/FE-interview/blog</link>
        <description>前端面试 Blog</description>
        <lastBuildDate>Mon, 21 Jul 2025 10:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-Hans</language>
        <item>
            <title><![CDATA[前端数据管理]]></title>
            <link>https://gvray.github.io/FE-interview/blog/2025/07/21/前端数据管理</link>
            <guid>https://gvray.github.io/FE-interview/blog/2025/07/21/前端数据管理</guid>
            <pubDate>Mon, 21 Jul 2025 10:00:00 GMT</pubDate>
            <description><![CDATA[🧱 状态管理目标]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_Xbio" id="-状态管理目标">🧱 状态管理目标<a href="https://gvray.github.io/FE-interview/blog/2025/07/21/%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86#-%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E7%9B%AE%E6%A0%87" class="hash-link" aria-label="🧱 状态管理目标的直接链接" title="🧱 状态管理目标的直接链接">​</a></h2>
<p>简化状态的「读、写、共享、持久化」
适用于：组件通信、服务端缓存、全局设置、UI 控制等</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="-react-数据流方案">⚛ React 数据流方案<a href="https://gvray.github.io/FE-interview/blog/2025/07/21/%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86#-react-%E6%95%B0%E6%8D%AE%E6%B5%81%E6%96%B9%E6%A1%88" class="hash-link" aria-label="⚛ React 数据流方案的直接链接" title="⚛ React 数据流方案的直接链接">​</a></h2>
<table><thead><tr><th>方案</th><th>优点</th><th>缺点</th><th>适用场景</th></tr></thead><tbody><tr><td><code>useState</code></td><td>原生轻量，无需依赖</td><td>无法共享跨组件状态</td><td>组件内部状态</td></tr><tr><td><code>Context</code></td><td>原生共享，适合简单全局变量（如主题）</td><td>粒度粗，更新全量触发 rerender</td><td>轻量全局状态</td></tr><tr><td>Redux Toolkit</td><td>标准、强类型、安全、DevTools 支持优秀</td><td>模板代码多，入门成本高</td><td>大型应用</td></tr><tr><td>Zustand</td><td>无模板代码，极简 API，模块化优秀，性能好</td><td>TS 推导有一定学习成本</td><td>中大型项目，推荐 ✅</td></tr><tr><td>Recoil / Jotai</td><td>原子化状态，适合局部嵌套组件优化</td><td>社区活跃度不足</td><td>实验型、可视化项目</td></tr><tr><td>MobX</td><td>响应式编程强大，代码简洁</td><td>隐式副作用多，调试困难</td><td>数据频繁变化的交互组件</td></tr></tbody></table>
<p>✅ <strong>推荐组合：</strong></p>
<ul>
<li>中后台：Zustand</li>
<li>大型复杂项目：Redux Toolkit</li>
<li>页面复杂嵌套：Recoil / MobX</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="-vue-数据流方案vue-3">🧩 Vue 数据流方案（Vue 3）<a href="https://gvray.github.io/FE-interview/blog/2025/07/21/%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86#-vue-%E6%95%B0%E6%8D%AE%E6%B5%81%E6%96%B9%E6%A1%88vue-3" class="hash-link" aria-label="🧩 Vue 数据流方案（Vue 3）的直接链接" title="🧩 Vue 数据流方案（Vue 3）的直接链接">​</a></h2>
<table><thead><tr><th>方案</th><th>优点</th><th>缺点</th><th>适用场景</th></tr></thead><tbody><tr><td><code>ref</code> / <code>reactive</code></td><td>原生，响应式语法简洁</td><td>跨组件共享不方便</td><td>组件内部状态</td></tr><tr><td><code>provide/inject</code></td><td>原生共享，适合依赖注入类业务</td><td>不可响应 / 使用复杂</td><td>嵌套组件通信</td></tr><tr><td>Vuex</td><td>模块化标准、成熟</td><td>写法繁琐、不支持 Composition API</td><td>Vue 2 项目维护期</td></tr><tr><td><strong>Pinia</strong> ✅</td><td>官方推荐，支持 Composition API、模块化好</td><td>插件体系相对较小</td><td>Vue 3 项目首选 ✅</td></tr></tbody></table>
<p>✅ <strong>推荐组合：</strong></p>
<ul>
<li>Vue 3 新项目：Pinia</li>
<li>简单组件：ref / reactive</li>
<li>状态抽象封装：自定义 useXXXStore + reactive</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="-umi-项目数据流react-系">⚙ Umi 项目数据流（React 系）<a href="https://gvray.github.io/FE-interview/blog/2025/07/21/%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86#-umi-%E9%A1%B9%E7%9B%AE%E6%95%B0%E6%8D%AE%E6%B5%81react-%E7%B3%BB" class="hash-link" aria-label="⚙ Umi 项目数据流（React 系）的直接链接" title="⚙ Umi 项目数据流（React 系）的直接链接">​</a></h2>
<p>Umi 本身基于 React，因此支持所有 React 状态管理方案，另外提供 2 种专属机制：</p>
<h3 class="anchor anchorWithStickyNavbar_Xbio" id="1-umijsplugins---plugin-modelusemodel">1. <code>@umijs/plugins</code> - <code>plugin-model</code>（useModel）<a href="https://gvray.github.io/FE-interview/blog/2025/07/21/%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86#1-umijsplugins---plugin-modelusemodel" class="hash-link" aria-label="1-umijsplugins---plugin-modelusemodel的直接链接" title="1-umijsplugins---plugin-modelusemodel的直接链接">​</a></h3>
<blockquote>
<p>✅ 官方推荐 Hooks 数据流方案，<strong>是 DVA 替代品</strong></p>
</blockquote>
<table><thead><tr><th>特点</th><th>说明</th></tr></thead><tbody><tr><td>轻量、函数式</td><td>类似 Zustand 思维，推荐组合式抽离</td></tr><tr><td>支持全局和局部 model</td><td>可拆分模块</td></tr><tr><td>支持异步、缓存、订阅等</td><td>结合 <code>useRequest</code> 使用更强大</td></tr></tbody></table>
<p>适合：Umi 3/4 项目，Hooks 风格</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_Xbio" id="2--dvaumi-2x-默认集成redux--redux-saga-封装">2. ✅ <strong>DVA</strong>（Umi 2.x 默认集成，Redux + Redux-saga 封装）<a href="https://gvray.github.io/FE-interview/blog/2025/07/21/%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86#2--dvaumi-2x-%E9%BB%98%E8%AE%A4%E9%9B%86%E6%88%90redux--redux-saga-%E5%B0%81%E8%A3%85" class="hash-link" aria-label="2--dvaumi-2x-默认集成redux--redux-saga-封装的直接链接" title="2--dvaumi-2x-默认集成redux--redux-saga-封装的直接链接">​</a></h3>
<table><thead><tr><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>成熟稳定、模块化清晰</td><td>写法陈旧、样板多、不支持 hooks</td></tr><tr><td>支持 effect、subscription</td><td>重依赖 redux-saga，异步逻辑不易维护</td></tr></tbody></table>
<p>适合：Umi 2 项目、需要订阅式模型、已有大量 DVA 模块的项目</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_Xbio" id="-umi-项目选型建议">⚖ Umi 项目选型建议<a href="https://gvray.github.io/FE-interview/blog/2025/07/21/%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86#-umi-%E9%A1%B9%E7%9B%AE%E9%80%89%E5%9E%8B%E5%BB%BA%E8%AE%AE" class="hash-link" aria-label="⚖ Umi 项目选型建议的直接链接" title="⚖ Umi 项目选型建议的直接链接">​</a></h3>
<table><thead><tr><th>项目类型</th><th>推荐数据流</th></tr></thead><tbody><tr><td>Umi 4 新项目</td><td><code>plugin-model</code> ✅</td></tr><tr><td>老项目</td><td>DVA（逐步迁移）</td></tr><tr><td>多模块复杂</td><td>Zustand + <code>plugin-model</code>组合</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="-选型建议一图流全栈视角">📌 选型建议一图流（全栈视角）<a href="https://gvray.github.io/FE-interview/blog/2025/07/21/%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86#-%E9%80%89%E5%9E%8B%E5%BB%BA%E8%AE%AE%E4%B8%80%E5%9B%BE%E6%B5%81%E5%85%A8%E6%A0%88%E8%A7%86%E8%A7%92" class="hash-link" aria-label="📌 选型建议一图流（全栈视角）的直接链接" title="📌 选型建议一图流（全栈视角）的直接链接">​</a></h2>
<table><thead><tr><th>框架</th><th>简单状态</th><th>共享状态（中小）</th><th>大型项目 / 多人协作</th></tr></thead><tbody><tr><td>React</td><td>useState</td><td>Zustand ✅</td><td>Redux Toolkit</td></tr><tr><td>Vue</td><td>ref</td><td>Pinia ✅</td><td>Pinia + 模块化封装</td></tr><tr><td>Umi</td><td>useModel</td><td>useModel ✅</td><td>Zustand / Redux（无 DVA）</td></tr><tr><td>Umi 2</td><td>useState</td><td>DVA（维护期）</td><td>可逐步迁移 useModel</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="-总结一句话">✅ 总结一句话<a href="https://gvray.github.io/FE-interview/blog/2025/07/21/%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86#-%E6%80%BB%E7%BB%93%E4%B8%80%E5%8F%A5%E8%AF%9D" class="hash-link" aria-label="✅ 总结一句话的直接链接" title="✅ 总结一句话的直接链接">​</a></h2>
<blockquote>
<p><strong>React 推荐 Zustand / Redux，Vue 推荐 Pinia，Umi 项目首选 useModel，DVA 适用于旧项目维护期。</strong></p>
</blockquote>]]></content:encoded>
            <category>数据管理</category>
        </item>
        <item>
            <title><![CDATA[图片的懒加载和预加载]]></title>
            <link>https://gvray.github.io/FE-interview/blog/图片的懒加载和预加载</link>
            <guid>https://gvray.github.io/FE-interview/blog/图片的懒加载和预加载</guid>
            <pubDate>Tue, 26 Nov 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[图片的懒加载（Lazy Loading）和预加载（Preloading）是两种优化网页加载性能的技术，分别针对不同的场景。]]></description>
            <content:encoded><![CDATA[<p>图片的懒加载（Lazy Loading）和预加载（Preloading）是两种优化网页加载性能的技术，分别针对不同的场景。</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="懒加载-lazy-loading"><strong>懒加载 (Lazy Loading)</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E6%87%92%E5%8A%A0%E8%BD%BD-lazy-loading" class="hash-link" aria-label="懒加载-lazy-loading的直接链接" title="懒加载-lazy-loading的直接链接">​</a></h2>
<p>懒加载是一种按需加载资源的技术，图片只有在用户即将看到它时（如滚动到视口范围内）才加载，而非页面初始渲染时就加载所有图片。</p>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="实现方式"><strong>实现方式</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F" class="hash-link" aria-label="实现方式的直接链接" title="实现方式的直接链接">​</a></h2>
<ol>
<li>
<p><strong>HTML 属性 <code>loading="lazy"</code></strong><br>
<!-- -->从 HTML5 开始，<code>&lt;img&gt;</code> 标签支持原生的 <code>loading</code> 属性：</p>
<div class="language-html codeBlockContainer__bYn theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oqyV"><pre tabindex="0" class="prism-code language-html codeBlock_pH9g thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xX5i"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">example.jpg</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alt</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">example</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">loading</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">lazy</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre><div class="buttonGroup_gqTI"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_lr74" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_PJSy"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_j3ue"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>浏览器会在图片即将进入视口前自动加载。</li>
</ul>
</li>
<li>
<p><strong>Intersection Observer</strong><br>
<!-- -->如果需要支持更复杂的场景或兼容性（如旧版浏览器），可以使用 JavaScript 的 Intersection Observer API：</p>
<div class="language-javascript codeBlockContainer__bYn theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oqyV"><pre tabindex="0" class="prism-code language-javascript codeBlock_pH9g thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xX5i"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> images </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">querySelectorAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'img[data-src]'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> observer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">IntersectionObserver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">entries</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> obs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    entries</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">entry</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">entry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">isIntersecting</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> img </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> entry</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            img</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> img</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dataset</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            obs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">unobserve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">images</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">img</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> observer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">observe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_gqTI"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_lr74" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_PJSy"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_j3ue"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在 HTML 中：</p>
<div class="language-html codeBlockContainer__bYn theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oqyV"><pre tabindex="0" class="prism-code language-html codeBlock_pH9g thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xX5i"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">img</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">data-src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">example.jpg</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">alt</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">example</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre><div class="buttonGroup_gqTI"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_lr74" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_PJSy"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_j3ue"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="优点"><strong>优点</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E4%BC%98%E7%82%B9" class="hash-link" aria-label="优点的直接链接" title="优点的直接链接">​</a></h2>
<ul>
<li><strong>减少首屏加载时间</strong>：只加载视口内的图片，加快页面初始渲染速度。</li>
<li><strong>节省带宽</strong>：未进入视口的图片不会被加载。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="缺点"><strong>缺点</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E7%BC%BA%E7%82%B9" class="hash-link" aria-label="缺点的直接链接" title="缺点的直接链接">​</a></h2>
<ul>
<li><strong>SEO 影响</strong>：对 SEO 不友好的懒加载可能导致搜索引擎抓取不到图片。</li>
<li><strong>兼容性</strong>：老旧浏览器可能不支持，需要提供回退方案。</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="预加载-preloading"><strong>预加载 (Preloading)</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E9%A2%84%E5%8A%A0%E8%BD%BD-preloading" class="hash-link" aria-label="预加载-preloading的直接链接" title="预加载-preloading的直接链接">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="定义"><strong>定义</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E5%AE%9A%E4%B9%89" class="hash-link" aria-label="定义的直接链接" title="定义的直接链接">​</a></h2>
<p>预加载是在资源实际需要之前提前加载，以确保资源在需要时立即可用，减少延迟。</p>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="实现方式-1"><strong>实现方式</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F-1" class="hash-link" aria-label="实现方式-1的直接链接" title="实现方式-1的直接链接">​</a></h2>
<ol>
<li>
<p><strong><code>&lt;link&gt;</code> 标签的 <code>rel="preload"</code></strong><br>
<!-- -->用于告诉浏览器优先加载某些资源：</p>
<div class="language-html codeBlockContainer__bYn theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oqyV"><pre tabindex="0" class="prism-code language-html codeBlock_pH9g thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xX5i"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">link</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">rel</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">preload</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">example.jpg</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">as</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag attr-value" style="color:#e3116c">image</span><span class="token tag attr-value punctuation" style="color:#393A34">"</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre><div class="buttonGroup_gqTI"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_lr74" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_PJSy"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_j3ue"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>JavaScript 动态加载</strong><br>
<!-- -->使用 JavaScript 创建 Image 对象来预加载图片：</p>
<div class="language-javascript codeBlockContainer__bYn theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oqyV"><pre tabindex="0" class="prism-code language-javascript codeBlock_pH9g thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xX5i"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> img </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">img</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'example.jpg'</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_gqTI"><button type="button" aria-label="�复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_lr74" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_PJSy"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_j3ue"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>CSS 的背景图预加载</strong><br>
<!-- -->使用 <code>@font-face</code> 或 <code>background-image</code> 提前加载图片资源：</p>
<div class="language-css codeBlockContainer__bYn theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oqyV"><pre tabindex="0" class="prism-code language-css codeBlock_pH9g thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xX5i"><span class="token-line" style="color:#393A34"><span class="token selector class" style="color:#00009f">.preload</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">background-image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token url function" style="color:#d73a49">url</span><span class="token url punctuation" style="color:#393A34">(</span><span class="token url string url" style="color:#36acaa">'example.jpg'</span><span class="token url punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">visibility</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> hidden</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_gqTI"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_lr74" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_PJSy"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_j3ue"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="优点-1"><strong>优点</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E4%BC%98%E7%82%B9-1" class="hash-link" aria-label="优点-1的直接链接" title="优点-1的直接链接">​</a></h2>
<ul>
<li><strong>提升用户体验</strong>：资源提前加载，减少交互时的等待时间。</li>
<li><strong>适用于关键资源</strong>：如页面首屏大图或重要交互图片。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="缺点-1"><strong>缺点</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E7%BC%BA%E7%82%B9-1" class="hash-link" aria-label="缺点-1的直接链接" title="缺点-1的直接链接">​</a></h2>
<ul>
<li><strong>增加初始加载时间</strong>：预加载会增加初始的网络请求，可能导致首屏渲染变慢。</li>
<li><strong>带宽浪费</strong>：如果资源未被实际使用，可能浪费用户带宽。</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="懒加载-vs-预加载"><strong>懒加载 vs. 预加载</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E6%87%92%E5%8A%A0%E8%BD%BD-vs-%E9%A2%84%E5%8A%A0%E8%BD%BD" class="hash-link" aria-label="懒加载-vs-预加载的直接链接" title="懒加载-vs-预加载的直接链接">​</a></h2>
<table><thead><tr><th>特性</th><th>懒加载</th><th>预加载</th></tr></thead><tbody><tr><td><strong>目的</strong></td><td>减少首屏加载压力，节省带宽</td><td>减少资源加载延迟</td></tr><tr><td><strong>触发时机</strong></td><td>用户需要时（滚动到视口）</td><td>页面加载时提前加载</td></tr><tr><td><strong>适用场景</strong></td><td>非首屏图片或次要资源</td><td>首屏关键资源或未来会使用的资源</td></tr><tr><td><strong>缺点</strong></td><td>可能影响 SEO 和兼容性</td><td>增加初始网络请求负担</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="综合应用"><strong>综合应用</strong><a href="https://gvray.github.io/FE-interview/blog/%E5%9B%BE%E7%89%87%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E9%A2%84%E5%8A%A0%E8%BD%BD#%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8" class="hash-link" aria-label="综合应用的直接链接" title="综合应用的直接链接">​</a></h2>
<p>在实际开发中，可以将懒加载和预加载结合使用。例如：</p>
<ul>
<li>对首屏的关键资源（如 Hero 图片）使用预加载。</li>
<li>对非首屏的次要图片使用懒加载，减少加载压力。</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_E02C alert alert--success"><div class="admonitionHeading_cGuG"><span class="admonitionIcon_j9Er"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_i0kc"><ul>
<li>预加载：提前加载图片，当用户需要查看时可直接从本地缓存中渲染。</li>
<li>懒加载：懒加载的主要目的是作为服务器前端的优化，减少请求数或延迟请求数。</li>
<li>两种技术的本质：两者的行为是相反的，一个是提前加载，一个是迟缓甚至不加载。</li>
<li>懒加载对服务器前端有一定的缓解压力作用，预加载则会增加服务器前端压力。</li>
</ul></div></div>]]></content:encoded>
            <category>图片加载</category>
        </item>
        <item>
            <title><![CDATA[什么是单点登录，以及如何进行实现？]]></title>
            <link>https://gvray.github.io/FE-interview/blog/什么是单点登录，以及如何进行实现？</link>
            <guid>https://gvray.github.io/FE-interview/blog/什么是单点登录，以及如何进行实现？</guid>
            <pubDate>Sat, 10 Feb 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[什么是单点登录？]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_Xbio" id="什么是单点登录">什么是单点登录？<a href="https://gvray.github.io/FE-interview/blog/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%AE%9E%E7%8E%B0%EF%BC%9F#%E4%BB%80%E4%B9%88%E6%98%AF%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95" class="hash-link" aria-label="什么是单点登录？的直接链接" title="什么是单点登录？的直接链接">​</a></h2>
<p>单点登录全称Single Sign On（以下简称SSO），是指在多系统应用群中登录一个系统，便可在其他所有系统中得到授权而无需再次登录，包括单点登录与单点注销两部分。</p>
<p>比如：淘宝、天猫都属于阿里旗下，当用户登录淘宝后，再打开天猫，系统便自动帮用户登录了天猫，这种现象就属于单点登录。</p>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="登录流程">登录流程<a href="https://gvray.github.io/FE-interview/blog/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%AE%9E%E7%8E%B0%EF%BC%9F#%E7%99%BB%E5%BD%95%E6%B5%81%E7%A8%8B" class="hash-link" aria-label="登录流程的直接链接" title="登录流程的直接链接">​</a></h2>
<p>相比于单系统登录，sso需要一个独立的认证中心，只有认证中心能接受用户的用户名密码等安全信息，其他系统不提供登录入口，只接受认证中心的间接授权。间接授权通过令牌实现，sso认证中心验证用户的用户名密码没问题，创建授权令牌，在接下来的跳转过程中，授权令牌作为参数发送给各个子系统，子系统拿到令牌，即得到了授权，可以借此创建局部会话，局部会话登录方式与单系统的登录方式相同。这个过程，也就是单点登录的原理，用下图说明</p>
<p><img decoding="async" loading="lazy" alt="单点登录" src="https://gvray.github.io/FE-interview/assets/images/denglu-ef649b99a445ffb39e1c5b329912b5d4.png" width="737" height="931" class="img_KZJw"></p>
<p>　下面对上图简要描述</p>
<ol>
<li>用户访问系统1的受保护资源，系统1发现用户未登录，跳转至sso认证中心，并将自己的地址作为参数</li>
<li>sso认证中心发现用户未登录，将用户引导至登录页面</li>
<li>用户输入用户名密码提交登录申请</li>
<li>sso认证中心校验用户信息，创建用户与sso认证中心之间的会话，称为全局会话，同时创建授权令牌</li>
<li>sso认证中心带着令牌跳转会最初的请求地址（系统1）</li>
<li>系统1拿到令牌，去sso认证中心校验令牌是否有效</li>
<li>sso认证中心校验令牌，返回有效，注册系统1</li>
<li>系统1使用该令牌创建与用户的会话，称为局部会话，返回受保护资源</li>
<li>用户访问系统2的受保护资源</li>
<li>系统2发现用户未登录，跳转至sso认证中心，并将自己的地址作为参数</li>
<li>sso认证中心发现用户已登录，跳转回系统2的地址，并附上令牌</li>
<li>系统2拿到令牌，去sso认证中心校验令牌是否有效</li>
<li>sso认证中心校验令牌，返回有效，注册系统2</li>
<li>系统2使用该令牌创建与用户的局部会话，返回受保护资源</li>
</ol>
<p>用户登录成功之后，会与sso认证中心及各个子系统建立会话，用户与sso认证中心建立的会话称为全局会话，用户与各个子系统建立的会话称为局部会话，局部会话建立之后，用户访问子系统受保护资源将不再通过sso认证中心，全局会话与局部会话有如下约束关系</p>
<ol>
<li>局部会话存在，全局会话一定存在</li>
<li>全局会话存在，局部会话不一定存在</li>
<li>全局会话销毁，局部会话必须销毁</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_Xbio" id="前端实现方式">前端实现方式<a href="https://gvray.github.io/FE-interview/blog/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%AE%9E%E7%8E%B0%EF%BC%9F#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F" class="hash-link" aria-label="前端实现方式的直接链接" title="前端实现方式的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_Xbio" id="同域名下的单点登录">同域名下的单点登录<a href="https://gvray.github.io/FE-interview/blog/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%AE%9E%E7%8E%B0%EF%BC%9F#%E5%90%8C%E5%9F%9F%E5%90%8D%E4%B8%8B%E7%9A%84%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95" class="hash-link" aria-label="同域名下的单点登录的直接链接" title="同域名下的单点登录的直接链接">​</a></h3>
<p><code>cookie</code>的<code>domin</code>属性设置为当前域的父域，并且父域的<code>cookie</code>会被子域所共享。<code>path</code>属性默认为<code>web</code>应用的上下文路径</p>
<p>利用 <code>Cookie</code> 的这个特点，没错，我们只需要将<code>Cookie</code>的<code> domain</code>属性设置为父域的域名（主域名），同时将 <code>Cookie </code>的<code>path</code>属性设置为根路径，将 <code>Session ID</code>（或 <code>Token</code>）保存到父域中。这样所有的子域应用就都可以访问到这个<code>Cookie</code></p>
<p>不过这要求应用系统的域名需建立在一个共同的主域名之下，如 <code>tieba.baidu.com</code> 和 <code>map.baidu.com</code>，它们都建立在 <code>baidu.com </code>这个主域名之下，那么它们就可以通过这种方式来实现单点登录</p>
<div class="language-js codeBlockContainer__bYn theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oqyV"><pre tabindex="0" class="prism-code language-js codeBlock_pH9g thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xX5i"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 在父域中设置 Cookie</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cookie</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sessionId=abc123; domain=.example.com; path=/"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 在子域中读取 Cookie</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cookies </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cookie</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"; "</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> sessionId</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> cookies</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> cookie </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cookies</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"="</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cookie</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sessionId"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sessionId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cookie</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 使用 Session ID 进行其他操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Session ID:"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sessionId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_gqTI"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_lr74" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_PJSy"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_j3ue"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_Xbio" id="不同域名下的单点登录一">不同域名下的单点登录(一)<a href="https://gvray.github.io/FE-interview/blog/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%AE%9E%E7%8E%B0%EF%BC%9F#%E4%B8%8D%E5%90%8C%E5%9F%9F%E5%90%8D%E4%B8%8B%E7%9A%84%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E4%B8%80" class="hash-link" aria-label="不同域名下的单点登录(一)的直接链接" title="不同域名下的单点登录(一)的直接链接">​</a></h3>
<p>如果是不同域的情况下，<code>Cookie</code>是不共享的，这里我们可以部署一个认证中心，用于专门处理登录请求的独立的 <code>Web </code>服务</p>
<p>用户统一在认证中心进行登录，登录成功后，认证中心记录用户的登录状态，并将 <code>token</code> 写入 <code>Cookie</code>（注意这个 <code>Cookie </code>是认证中心的，应用系统是访问不到的）</p>
<p>应用系统检查当前请求有没有 <code>Token</code>，如果没有，说明用户在当前系统中尚未登录，那么就将页面跳转至认证中心</p>
<p>由于这个操作会将认证中心的 <code>Cookie</code> 自动带过去，因此，认证中心能够根据 <code>Cookie</code> 知道用户是否已经登录过了</p>
<p>如果认证中心发现用户尚未登录，则返回登录页面，等待用户登录</p>
<p>如果发现用户已经登录过了，就不会让用户再次登录了，而是会跳转回目标 <code>URL </code>，并在跳转前生成一个 <code>Token</code>，拼接在目标<code> URL</code> 的后面，回传给目标应用系统</p>
<p>应用系统拿到 <code>Token </code>之后，还需要向认证中心确认下 <code>Token</code> 的合法性，防止用户伪造。确认无误后，应用系统记录用户的登录状态，并将 <code>Token </code>写入<code> Cookie</code>，然后给本次访问放行。（注意这个 <code>Cookie</code> 是当前应用系统的）当用户再次访问当前应用系统时，就会自动带上这个 <code>Token</code>，应用系统验证 Token 发现用户已登录，于是就不会有认证中心什么事了</p>
<p>此种实现方式相对复杂，支持跨域，扩展性好，是单点登录的标准做法</p>
<h3 class="anchor anchorWithStickyNavbar_Xbio" id="不同域名下的单点登录二">不同域名下的单点登录(二)<a href="https://gvray.github.io/FE-interview/blog/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%AE%9E%E7%8E%B0%EF%BC%9F#%E4%B8%8D%E5%90%8C%E5%9F%9F%E5%90%8D%E4%B8%8B%E7%9A%84%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E4%BA%8C" class="hash-link" aria-label="不同域名下的单点登录(二)的直接链接" title="不同域名下的单点登录(二)的直接链接">​</a></h3>
<p>可以选择将 <code>Session ID</code> （或 <code>Token</code> ）保存到浏览器的 <code>LocalStorage</code> 中，让前端在每次向后端发送请求时，主动将<code>LocalStorage</code>的数据传递给服务端</p>
<p>这些都是由前端来控制的，后端需要做的仅仅是在用户登录成功后，将 <code>Session ID </code>（或 <code>Token </code>）放在响应体中传递给前端</p>
<p>单点登录完全可以在前端实现。前端拿到 <code>Session ID </code>（或 <code>Token</code> ）后，除了将它写入自己的 <code>LocalStorage</code> 中之外，还可以通过特殊手段将它写入多个其他域下的 <code>LocalStorage</code> 中</p>
<div class="language-js codeBlockContainer__bYn theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oqyV"><pre tabindex="0" class="prism-code language-js codeBlock_pH9g thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xX5i"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 获取 token</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> token </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">token</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 动态创建一个不可见的iframe，在iframe中加载一个跨域HTML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> iframe </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"iframe"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iframe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">src</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"http://app1.com/localstorage.html"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">document</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">body</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">iframe</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 使用postMessage()方法将token传递给iframe</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">setTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    iframe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">contentWindow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">postMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">token</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"http://app1.com"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">setTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    iframe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 在这个iframe所加载的HTML中绑定一个事件监听器，当事件被触发时，把接收到的token数据写入localStorage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'message'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token dom variable" style="color:#36acaa">localStorage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setItem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'token'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_gqTI"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_lr74" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_PJSy"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_j3ue"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>前端通过 <code>iframe</code>+<code>postMessage()</code> 方式，将同一份 <code>Token</code> 写入到了多个域下的 <code>LocalStorage</code> 中，前端每次在向后端发送请求之前，都会主动从 <code>LocalStorage</code> 中读取<code>Token</code>并在请求中携带，这样就实现了同一份<code> Token</code> 被多个域所共享</p>
<p>此种实现方式完全由前端控制，几乎不需要后端参与，同样支持跨域</p>
<p>参考链接：</p>
<p><a href="https://www.cnblogs.com/zbliao/p/13809846.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/zbliao/p/13809846.html</a></p>]]></content:encoded>
            <category>单点登录</category>
            <category>鉴权</category>
        </item>
    </channel>
</rss>
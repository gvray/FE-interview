"use strict";(globalThis.webpackChunkfe_interview=globalThis.webpackChunkfe_interview||[]).push([[8136],{2237(e,c,n){n.r(c),n.d(c,{assets:()=>h,contentTitle:()=>r,default:()=>j,frontMatter:()=>t,metadata:()=>l,toc:()=>i});var d=n(86070),s=n(31832);const t={},r="\ud83e\udde0 Vue watch vs watchEffect \u5168\u9762\u5bf9\u6bd4",l={id:"frame/vue3/7",title:"\ud83e\udde0 Vue watch vs watchEffect \u5168\u9762\u5bf9\u6bd4",description:"\ud83c\udfaf \u4e00\u53e5\u8bdd\u533a\u522b\uff08\u9762\u8bd5\u53e3\u8bed\u7248\uff09",source:"@site/docs/frame/vue3/7.md",sourceDirName:"frame/vue3",slug:"/frame/vue3/7",permalink:"/FE-interview/docs/frame/vue3/7",draft:!1,unlisted:!1,editUrl:"https://github.com/gvray/FE-interview/tree/main/docs/frame/vue3/7.md",tags:[],version:"current",frontMatter:{},sidebar:"frame",previous:{title:"Vue3\u65b0\u7ec4\u4ef6",permalink:"/FE-interview/docs/frame/vue3/6"},next:{title:"\ud83c\udfaf Vue scoped \u6837\u5f0f\u7a7f\u900f\u673a\u5236",permalink:"/FE-interview/docs/frame/vue3/8"}},h={},i=[{value:"\u2705 \u4e00\u3001\u5b9a\u4e49\u4e0e\u8bed\u6cd5",id:"-\u4e00\u5b9a\u4e49\u4e0e\u8bed\u6cd5",level:2},{value:"\u2705 \u4e8c\u3001\u4f7f\u7528\u793a\u4f8b\u5bf9\u6bd4",id:"-\u4e8c\u4f7f\u7528\u793a\u4f8b\u5bf9\u6bd4",level:2},{value:"watch \u793a\u4f8b\uff08\u663e\u5f0f\u4f9d\u8d56\uff09\uff1a",id:"watch-\u793a\u4f8b\u663e\u5f0f\u4f9d\u8d56",level:3},{value:"watchEffect \u793a\u4f8b\uff08\u81ea\u52a8\u4f9d\u8d56\uff09\uff1a",id:"watcheffect-\u793a\u4f8b\u81ea\u52a8\u4f9d\u8d56",level:3},{value:"\u2705 \u4e09\u3001\u4f9d\u8d56\u6536\u96c6\u673a\u5236",id:"-\u4e09\u4f9d\u8d56\u6536\u96c6\u673a\u5236",level:2},{value:"\u2705 \u56db\u3001\u5178\u578b\u5e94\u7528\u573a\u666f",id:"-\u56db\u5178\u578b\u5e94\u7528\u573a\u666f",level:2},{value:"\ud83d\udd39 <code>watch</code> \u9002\u7528\u573a\u666f\uff1a",id:"-watch-\u9002\u7528\u573a\u666f",level:3},{value:"\ud83d\udd39 <code>watchEffect</code> \u9002\u7528\u573a\u666f\uff1a",id:"-watcheffect-\u9002\u7528\u573a\u666f",level:3},{value:"\u2705 \u4e94\u3001\u9677\u9631 &amp; \u6ce8\u610f\u4e8b\u9879",id:"-\u4e94\u9677\u9631--\u6ce8\u610f\u4e8b\u9879",level:2},{value:"\u2705 \u516d\u3001\u5b9e\u73b0\u539f\u7406\uff08\u8fdb\u9636\u53ef\u9009\uff09",id:"-\u516d\u5b9e\u73b0\u539f\u7406\u8fdb\u9636\u53ef\u9009",level:2},{value:"\u2705 \u4e03\u3001\u6700\u7ec8\u603b\u7ed3\u53e3\u8bc0\uff08\u9762\u8bd5\u53ef\u80cc\uff09",id:"-\u4e03\u6700\u7ec8\u603b\u7ed3\u53e3\u8bc0\u9762\u8bd5\u53ef\u80cc",level:2}];function x(e){const c={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(c.h1,{id:"-vue-watch-vs-watcheffect-\u5168\u9762\u5bf9\u6bd4",children:["\ud83e\udde0 Vue ",(0,d.jsx)(c.code,{children:"watch"})," vs ",(0,d.jsx)(c.code,{children:"watchEffect"})," \u5168\u9762\u5bf9\u6bd4"]}),"\n",(0,d.jsx)(c.p,{children:"\ud83c\udfaf \u4e00\u53e5\u8bdd\u533a\u522b\uff08\u9762\u8bd5\u53e3\u8bed\u7248\uff09"}),"\n",(0,d.jsxs)(c.blockquote,{children:["\n",(0,d.jsxs)(c.p,{children:[(0,d.jsx)(c.code,{children:"watch"})," \u66f4\u50cf\u662f\u201c\u89c2\u5bdf\u4e00\u4e2a\u660e\u786e\u7684\u6570\u636e\u6e90\u201d\uff0c\u800c ",(0,d.jsx)(c.code,{children:"watchEffect"})," \u662f\u201c\u81ea\u52a8\u6536\u96c6\u4f9d\u8d56\uff0c\u53ea\u8981\u8bbf\u95ee\u4e86\u54cd\u5e94\u5f0f\u6570\u636e\u5c31\u4f1a\u89e6\u53d1\u201d\u3002"]}),"\n"]}),"\n",(0,d.jsx)(c.hr,{}),"\n",(0,d.jsx)(c.h2,{id:"-\u4e00\u5b9a\u4e49\u4e0e\u8bed\u6cd5",children:"\u2705 \u4e00\u3001\u5b9a\u4e49\u4e0e\u8bed\u6cd5"}),"\n",(0,d.jsxs)(c.table,{children:[(0,d.jsx)(c.thead,{children:(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.th,{children:"\u7279\u6027"}),(0,d.jsx)(c.th,{children:(0,d.jsx)(c.code,{children:"watch"})}),(0,d.jsx)(c.th,{children:(0,d.jsx)(c.code,{children:"watchEffect"})})]})}),(0,d.jsxs)(c.tbody,{children:[(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u662f\u5426\u81ea\u52a8\u6536\u96c6\u4f9d\u8d56"}),(0,d.jsxs)(c.td,{children:["\u274c \u5426\uff0c\u9700",(0,d.jsx)(c.strong,{children:"\u663e\u5f0f\u6307\u5b9a\u4f9d\u8d56\u6e90"})]}),(0,d.jsxs)(c.td,{children:["\u2705 \u662f\uff0c",(0,d.jsx)(c.strong,{children:"\u81ea\u52a8\u8ffd\u8e2a\u540c\u6b65\u8bbf\u95ee\u7684\u54cd\u5e94\u5f0f\u4f9d\u8d56"})]})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u4e3b\u8981\u7528\u9014"}),(0,d.jsxs)(c.td,{children:["\u54cd\u5e94\u67d0\u4e2a",(0,d.jsx)(c.strong,{children:"\u7279\u5b9a\u6570\u636e\u6e90\u7684\u53d8\u5316"}),"\uff0c\u5e38\u7528\u4e8e\u526f\u4f5c\u7528\uff08\u5982\u8bf7\u6c42\uff09"]}),(0,d.jsxs)(c.td,{children:["\u5904\u7406",(0,d.jsx)(c.strong,{children:"\u526f\u4f5c\u7528\u903b\u8f91"}),"\uff0c\u81ea\u52a8\u8ffd\u8e2a\u4f9d\u8d56"]})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u56de\u8c03\u53c2\u6570"}),(0,d.jsx)(c.td,{children:(0,d.jsx)(c.code,{children:"(newVal, oldVal, onCleanup)"})}),(0,d.jsxs)(c.td,{children:[(0,d.jsx)(c.code,{children:"(onCleanup)"}),"\uff08\u4e0d\u80fd\u62ff\u5230 new/old \u503c\uff09"]})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u652f\u6301\u61d2\u6267\u884c"}),(0,d.jsxs)(c.td,{children:["\u2705 \u9ed8\u8ba4\u61d2\u6267\u884c\uff0c",(0,d.jsx)(c.code,{children:"immediate: true"})," \u53ef\u7acb\u5373\u6267\u884c"]}),(0,d.jsx)(c.td,{children:"\u274c \u9ed8\u8ba4\u7acb\u5373\u6267\u884c"})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u53ef\u7528\u4e8e\u5f02\u6b65\u903b\u8f91"}),(0,d.jsxs)(c.td,{children:["\u2705 \u652f\u6301\u826f\u597d\uff0c\u7ed3\u5408 ",(0,d.jsx)(c.code,{children:"onCleanup()"})," \u4f7f\u7528"]}),(0,d.jsx)(c.td,{children:"\u2705 \u652f\u6301\u826f\u597d\uff0c\u9002\u5408\u8f7b\u91cf\u526f\u4f5c\u7528\u903b\u8f91"})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u6e05\u7406\u526f\u4f5c\u7528"}),(0,d.jsxs)(c.td,{children:["\u2705 ",(0,d.jsx)(c.code,{children:"onCleanup(fn)"})]}),(0,d.jsxs)(c.td,{children:["\u2705 ",(0,d.jsx)(c.code,{children:"onCleanup(fn)"})]})]})]})]}),"\n",(0,d.jsx)(c.hr,{}),"\n",(0,d.jsx)(c.h2,{id:"-\u4e8c\u4f7f\u7528\u793a\u4f8b\u5bf9\u6bd4",children:"\u2705 \u4e8c\u3001\u4f7f\u7528\u793a\u4f8b\u5bf9\u6bd4"}),"\n",(0,d.jsx)(c.h3,{id:"watch-\u793a\u4f8b\u663e\u5f0f\u4f9d\u8d56",children:"watch \u793a\u4f8b\uff08\u663e\u5f0f\u4f9d\u8d56\uff09\uff1a"}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{className:"language-ts",children:"watch(() => props.id, (newVal, oldVal) => {\n  fetchData(newVal)\n})\n"})}),"\n",(0,d.jsx)(c.h3,{id:"watcheffect-\u793a\u4f8b\u81ea\u52a8\u4f9d\u8d56",children:"watchEffect \u793a\u4f8b\uff08\u81ea\u52a8\u4f9d\u8d56\uff09\uff1a"}),"\n",(0,d.jsx)(c.pre,{children:(0,d.jsx)(c.code,{className:"language-ts",children:"watchEffect(() => {\n  fetchData(props.id) // \u53ea\u8981 props.id \u6539\u53d8\u5c31\u91cd\u65b0\u6267\u884c\n})\n"})}),"\n",(0,d.jsx)(c.hr,{}),"\n",(0,d.jsx)(c.h2,{id:"-\u4e09\u4f9d\u8d56\u6536\u96c6\u673a\u5236",children:"\u2705 \u4e09\u3001\u4f9d\u8d56\u6536\u96c6\u673a\u5236"}),"\n",(0,d.jsxs)(c.table,{children:[(0,d.jsx)(c.thead,{children:(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.th,{children:"\u7279\u6027"}),(0,d.jsx)(c.th,{children:"watch"}),(0,d.jsx)(c.th,{children:"watchEffect"})]})}),(0,d.jsxs)(c.tbody,{children:[(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u54cd\u5e94\u5f0f\u8ffd\u8e2a\u8303\u56f4"}),(0,d.jsx)(c.td,{children:"\u53ea\u8ffd\u8e2a getter \u51fd\u6570\u7684\u8fd4\u56de\u503c"}),(0,d.jsxs)(c.td,{children:["\u8ffd\u8e2a\u51fd\u6570\u4f53\u5185",(0,d.jsx)(c.strong,{children:"\u540c\u6b65\u8bbf\u95ee\u7684\u6240\u6709\u54cd\u5e94\u5f0f\u6570\u636e"})]})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u652f\u6301\u6df1\u5c42\u8c03\u7528\u94fe"}),(0,d.jsx)(c.td,{children:"\u2705\uff0cgetter \u4e2d\u8bbf\u95ee\u6df1\u5c42\u54cd\u5e94\u5f0f\u6570\u636e\u4f1a\u88ab\u8ffd\u8e2a"}),(0,d.jsx)(c.td,{children:"\u2705\uff0c\u53ea\u8981\u8bbf\u95ee\u4e86\u54cd\u5e94\u5f0f\u6570\u636e\u5c31\u4f1a\u88ab\u8ffd\u8e2a"})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u5f02\u6b65\u4ee3\u7801\u5185\u8bbf\u95ee\u54cd\u5e94\u5f0f"}),(0,d.jsx)(c.td,{children:"\u274c \u4e0d\u8ffd\u8e2a"}),(0,d.jsx)(c.td,{children:"\u274c \u4e0d\u8ffd\u8e2a"})]})]})]}),"\n",(0,d.jsx)(c.hr,{}),"\n",(0,d.jsx)(c.h2,{id:"-\u56db\u5178\u578b\u5e94\u7528\u573a\u666f",children:"\u2705 \u56db\u3001\u5178\u578b\u5e94\u7528\u573a\u666f"}),"\n",(0,d.jsxs)(c.h3,{id:"-watch-\u9002\u7528\u573a\u666f",children:["\ud83d\udd39 ",(0,d.jsx)(c.code,{children:"watch"})," \u9002\u7528\u573a\u666f\uff1a"]}),"\n",(0,d.jsxs)(c.ul,{children:["\n",(0,d.jsx)(c.li,{children:"\u660e\u786e\u76d1\u542c\u67d0\u4e2a\u54cd\u5e94\u5f0f\u503c\uff0c\u5982\uff1aprops\u3001\u8def\u7531\u53c2\u6570\u7b49"}),"\n",(0,d.jsxs)(c.li,{children:["\u5e0c\u671b\u62ff\u5230 ",(0,d.jsx)(c.code,{children:"newVal / oldVal"})]}),"\n",(0,d.jsx)(c.li,{children:"\u60f3\u8981\u61d2\u89e6\u53d1\u526f\u4f5c\u7528\uff0c\u6216\u624b\u52a8\u63a7\u5236\u6267\u884c\u65f6\u673a"}),"\n"]}),"\n",(0,d.jsxs)(c.h3,{id:"-watcheffect-\u9002\u7528\u573a\u666f",children:["\ud83d\udd39 ",(0,d.jsx)(c.code,{children:"watchEffect"})," \u9002\u7528\u573a\u666f\uff1a"]}),"\n",(0,d.jsxs)(c.ul,{children:["\n",(0,d.jsx)(c.li,{children:"\u54cd\u5e94\u5f0f\u6570\u636e\u53ef\u80fd\u6709\u591a\u4e2a\u6765\u6e90"}),"\n",(0,d.jsx)(c.li,{children:"\u5feb\u901f\u5b9e\u73b0\u54cd\u5e94\u5f0f\u526f\u4f5c\u7528\uff0c\u5982\u81ea\u52a8 fetch\u3001\u540c\u6b65 DOM"}),"\n",(0,d.jsxs)(c.li,{children:["\u66f4\u50cf\u662f ",(0,d.jsx)(c.code,{children:"computed"})," + ",(0,d.jsx)(c.code,{children:"watch"})," \u7684\u7ec4\u5408"]}),"\n"]}),"\n",(0,d.jsx)(c.hr,{}),"\n",(0,d.jsx)(c.h2,{id:"-\u4e94\u9677\u9631--\u6ce8\u610f\u4e8b\u9879",children:"\u2705 \u4e94\u3001\u9677\u9631 & \u6ce8\u610f\u4e8b\u9879"}),"\n",(0,d.jsxs)(c.table,{children:[(0,d.jsx)(c.thead,{children:(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.th,{children:"\u60c5\u51b5"}),(0,d.jsx)(c.th,{children:"watch"}),(0,d.jsx)(c.th,{children:"watchEffect"})]})}),(0,d.jsxs)(c.tbody,{children:[(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u5f02\u6b65\u4e2d\u8bbf\u95ee\u54cd\u5e94\u5f0f\u503c\u4e0d\u4f1a\u88ab\u8ffd\u8e2a"}),(0,d.jsx)(c.td,{children:"\u2757 \u4e0d\u4f1a"}),(0,d.jsx)(c.td,{children:"\u2757 \u4e0d\u4f1a"})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u6539\u53d8\u7684\u503c\u662f\u6df1\u5c42\u5bf9\u8c61\u5b57\u6bb5"}),(0,d.jsxs)(c.td,{children:["\u9700\u8981 ",(0,d.jsx)(c.code,{children:"deep: true"})]}),(0,d.jsx)(c.td,{children:"\u81ea\u52a8\u8ffd\u8e2a\uff0c\u9664\u975e\u88ab\u5f02\u6b65\u9694\u5f00"})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"\u7b2c\u4e00\u6b21\u662f\u5426\u6267\u884c"}),(0,d.jsx)(c.td,{children:"\u9ed8\u8ba4\u4e0d\u6267\u884c\uff0c\u9700\u914d\u7f6e"}),(0,d.jsx)(c.td,{children:"\u9ed8\u8ba4\u7acb\u5373\u6267\u884c"})]}),(0,d.jsxs)(c.tr,{children:[(0,d.jsx)(c.td,{children:"cleanup \u6e05\u7406\u526f\u4f5c\u7528\u7684\u65f6\u673a"}),(0,d.jsx)(c.td,{children:"\u4e0b\u4e00\u6b21\u6267\u884c\u524d\u6216\u7ec4\u4ef6\u5378\u8f7d"}),(0,d.jsx)(c.td,{children:"\u540c\u5de6"})]})]})]}),"\n",(0,d.jsx)(c.hr,{}),"\n",(0,d.jsx)(c.h2,{id:"-\u516d\u5b9e\u73b0\u539f\u7406\u8fdb\u9636\u53ef\u9009",children:"\u2705 \u516d\u3001\u5b9e\u73b0\u539f\u7406\uff08\u8fdb\u9636\u53ef\u9009\uff09"}),"\n",(0,d.jsxs)(c.ul,{children:["\n",(0,d.jsxs)(c.li,{children:[(0,d.jsx)(c.code,{children:"watch"})," \u901a\u8fc7\u4f20\u5165\u4e00\u4e2a getter \u663e\u5f0f\u6536\u96c6\u4f9d\u8d56\uff08\u53ea\u8ffd\u8e2a\u8fd4\u56de\u503c\uff09"]}),"\n",(0,d.jsxs)(c.li,{children:[(0,d.jsx)(c.code,{children:"watchEffect"})," \u5728\u6267\u884c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u5168\u5c40 ",(0,d.jsx)(c.code,{children:"activeEffect"}),"\uff0c\u5728\u540c\u6b65\u51fd\u6570\u4f53\u4e2d\u8bbf\u95ee\u7684\u54cd\u5e94\u5f0f\u6570\u636e\u4f1a\u8c03\u7528 ",(0,d.jsx)(c.code,{children:"track()"})," \u81ea\u52a8\u5efa\u7acb\u4f9d\u8d56\u5173\u7cfb"]}),"\n",(0,d.jsxs)(c.li,{children:["\u54cd\u5e94\u5f0f\u6570\u636e\u672c\u8d28\u662f\u7528 ",(0,d.jsx)(c.code,{children:"Proxy"})," \u62e6\u622a ",(0,d.jsx)(c.code,{children:"get"}),"\uff0c\u5224\u65ad\u662f\u5426\u5b58\u5728 ",(0,d.jsx)(c.code,{children:"activeEffect"}),"\uff0c\u5982\u679c\u6709\u5c31\u8bb0\u5f55\u8fdb\u4f9d\u8d56\u96c6\u5408"]}),"\n"]}),"\n",(0,d.jsx)(c.hr,{}),"\n",(0,d.jsx)(c.h2,{id:"-\u4e03\u6700\u7ec8\u603b\u7ed3\u53e3\u8bc0\u9762\u8bd5\u53ef\u80cc",children:"\u2705 \u4e03\u3001\u6700\u7ec8\u603b\u7ed3\u53e3\u8bc0\uff08\u9762\u8bd5\u53ef\u80cc\uff09"}),"\n",(0,d.jsxs)(c.blockquote,{children:["\n",(0,d.jsx)(c.p,{children:(0,d.jsx)(c.strong,{children:"watch \u660e\u786e\u4f9d\u8d56\u3001\u61d2\u6267\u884c\uff0c\u9002\u5408\u7279\u5b9a\u5b57\u6bb5\uff1bwatchEffect \u81ea\u52a8\u4f9d\u8d56\u3001\u7acb\u5373\u6267\u884c\uff0c\u9002\u5408\u54cd\u5e94\u5f0f\u526f\u4f5c\u7528\u3002"})}),"\n"]}),"\n",(0,d.jsx)(c.hr,{})]})}function j(e={}){const{wrapper:c}={...(0,s.R)(),...e.components};return c?(0,d.jsx)(c,{...e,children:(0,d.jsx)(x,{...e})}):x(e)}},31832(e,c,n){n.d(c,{R:()=>r,x:()=>l});var d=n(30758);const s={},t=d.createContext(s);function r(e){const c=d.useContext(t);return d.useMemo(function(){return"function"==typeof e?e(c):{...c,...e}},[c,e])}function l(e){let c;return c=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),d.createElement(t.Provider,{value:c},e.children)}}}]);